# /etc/carbon/carbon.conf

##################################
# Rendered by Chef, do not edit! #
##################################

[cache]

STORAGE_DIR    = /var/lib/graphite/
CONF_DIR       = /etc/carbon/
LOG_DIR        = /var/log/carbon/
PID_DIR        = /var/run/

LOCAL_DATA_DIR = <%= node['oc-graphite']['carbon']['data_dir'] %>
USER = <%= node['oc-graphite']['carbon']['user'] %>

ENABLE_LOGROTATION = True
LOG_UPDATES = False
LOG_CACHE_HITS = False
LOG_CACHE_QUEUE_SORTS = True

MAX_CACHE_SIZE = inf
MAX_UPDATES_PER_SECOND = 500
MAX_CREATES_PER_MINUTE = 50

ENABLE_UDP_LISTENER = False

LINE_RECEIVER_INTERFACE = <%= node['oc-graphite']['carbon']['host'] %>
LINE_RECEIVER_PORT = <%= node['oc-graphite']['carbon']['port'] %>

PICKLE_RECEIVER_INTERFACE = <%= node['oc-graphite']['carbon']['host'] %>
PICKLE_RECEIVER_PORT = 2004

CACHE_QUERY_INTERFACE = <%= node['oc-graphite']['carbon']['host'] %>
CACHE_QUERY_PORT = 7002

USE_INSECURE_UNPICKLER = False

LOG_LISTENER_CONNECTIONS = True

USE_FLOW_CONTROL = True

CACHE_WRITE_STRATEGY = sorted
WHISPER_AUTOFLUSH = FALSE
WHISPER_FALLOCATE_CREATE = True

[relay]
LINE_RECEIVER_INTERFACE = <%= node['oc-graphite']['carbon']['host'] %>
LINE_RECEIVER_PORT = 2013
PICKLE_RECEIVER_INTERFACE = <%= node['oc-graphite']['carbon']['host'] %>
PICKLE_RECEIVER_PORT = 2014

LOG_LISTENER_CONNECTIONS = True

RELAY_METHOD = rules
REPLICATION_FACTOR = 1
DESTINATIONS = 127.0.0.1:2004

MAX_DATAPOINTS_PER_MESSAGE = 500
MAX_QUEUE_SIZE = 10000

USE_FLOW_CONTROL = True

[aggregator]
LINE_RECEIVER_INTERFACE = <%= node['oc-graphite']['carbon']['host'] %>
LINE_RECEIVER_PORT = 2023

PICKLE_RECEIVER_INTERFACE = <%= node['oc-graphite']['carbon']['host'] %>
PICKLE_RECEIVER_PORT = 2024


LOG_LISTENER_CONNECTIONS = True
FORWARD_ALL = True
DESTINATIONS = 127.0.0.1:2004

REPLICATION_FACTOR = 1
MAX_QUEUE_SIZE = 10000

MAX_DATAPOINTS_PER_MESSAGE = 500
MAX_AGGREGATION_INTERVALS = 5

USE_FLOW_CONTROL = True
